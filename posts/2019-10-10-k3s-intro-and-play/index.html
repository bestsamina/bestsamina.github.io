<!DOCTYPE html>
<html lang='en'><head>
  <title>é‚Šç·£é‹ç®—ä¹‹å®¹å™¨ç®¡ç†å·¥å…· - K3s ä¹‹ä»‹ç´¹èˆ‡ç©è€ - Samina Website</title>
  <link rel='canonical' href='https://bestsamina.github.io/posts/2019-10-10-k3s-intro-and-play/' />
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1' />
  <meta name='description' content='' />
  <meta name='theme-color' content='#D250F4' />
  
    <link rel="shortcut icon" href="/images/favicon.jpg" type="image/x-icon" />
    <link rel="icon" href="/images/favicon.jpg" type="image/x-icon" />
  

  <meta name="generator" content="Hugo 0.97.3" />

  





<link rel="stylesheet" href="https://bestsamina.github.io/sass/style.min.dc7c04d679aa2c892fdb6d910a9f9d319b602240bc157288fb462e0e09d67c14.css" integrity="sha256-3HwE1nmqLIkv222RCp&#43;dMZtgIkC8FXKI&#43;0YuDgnWfBQ=" media="screen">
<link rel="stylesheet" href="https://bestsamina.github.io/syntax.min.css" integrity="" media="screen">

  <meta property="og:title" content="é‚Šç·£é‹ç®—ä¹‹å®¹å™¨ç®¡ç†å·¥å…· - K3s ä¹‹ä»‹ç´¹èˆ‡ç©è€" />
<meta property="og:description" content="å‰è¨€ Kubernetes æ˜¯é›²åŸç”ŸæŠ€è¡“ (cloud-native technologies)ï¼Œä¹Ÿæ˜¯é›²åŸç”Ÿè¨ˆç®— (Cloud Native Computing) é‡è¦çš„æŠ€è¡“ä¹‹ä¸€ï¼Œè€Œä¸”åœ¨ä½¿ç”¨ Kubernetes æ™‚ï¼Œæ‡‰ç”¨çš„ç¡¬é«”è³‡æºé€šå¸¸ä¹Ÿæ¯”è¼ƒå¥½ã€‚ç„¶è€Œï¼Œ å®¹å™¨ (Container) æŠ€è¡“çš„å´›èµ·ï¼Œä¹Ÿå¸¶å‹•äº†é‚Šç·£é‹ç®— (Edge computing) å°å…¥ Container æŠ€è¡“çš„é¢¨æ½®ã€‚
é‚Šç·£é‹ç®—é¡§åæ€ç¾©å°±æ˜¯å°‡æ‡‰ç”¨ç¨‹å¼ç­‰æœå‹™é‹ç®—ï¼Œç”±ç¶²è·¯ä¸­å¿ƒç¯€é»ï¼Œç§»å¾€ç¶²è·¯é‚è¼¯ä¸Šçš„é‚Šç·£ç¯€é»ä¾†è™•ç†ã€‚ä¹Ÿå°±æ˜¯å¾ç¶²è·¯ä¸­å¿ƒç¯€é»è™•ç†å¤§å‹æœå‹™ä¾†åˆ†è§£ï¼Œåˆ‡å‰²æˆæ›´å°ã€æ›´å®¹æ˜“ç®¡ç†çš„éƒ¨ä»½ï¼Œåˆ†æ•£åˆ°é‚Šç·£ç¯€é»å»è™•ç†ã€‚å¯ä»¥æƒ³åƒï¼Œå¦‚æœç¶²è·¯ä¸­å¿ƒç¯€é»çš„è§’è‰²å¦‚åŒç¸½ç¶“ç†ï¼Œé‚Šç·£ç¯€é»çš„è§’è‰²å¦‚åŒéƒ¨é–€ç¶“ç†ï¼Œè€Œçµ‚ç«¯è£ç½®çš„è§’è‰²å¦‚åŒåŸºå±¤å“¡å·¥ã€‚åœ¨é€™æ¶æ§‹ä¸‹ï¼Œæƒ³ç•¶ç„¶è€³å°±æ˜¯å€‹åˆ†æ•£å¼æ¶æ§‹ï¼Œè€Œé‚Šç·£ç¯€é»å› ç‚ºæ›´æ¥è¿‘æ–¼çµ‚ç«¯è£ç½®ï¼Œå› æ­¤å¯ä»¥åŠ å¿«è³‡æ–™çš„è™•ç†èˆ‡å‚³é€é€Ÿåº¦ï¼Œæ¸›å°‘å»¶é²ã€‚å¦‚åŒåŸºå±¤å“¡å·¥ç›´ç¶“å›å ±éƒ¨é–€ç¶“ç†ï¼Œè€Œé‡è¦çš„è³‡è¨Šï¼Œéƒ¨é–€ç¶“ç†å†å›å ±çµ¦ç¸½ç¶“ç†ä¸€æ¨£ã€‚ä¹Ÿå› æ­¤åœ¨é‚Šç·£é‹ç®—çš„æ‡‰ç”¨ä¸­ä¸€ç›´éƒ½æœ‰é‡è¦çš„æ‡‰ç”¨å ´æ™¯åœ¨ï¼Œä¾‹å¦‚å¤§å®¶å¸¸è½åˆ°çš„ IoTã€‚
ç•¶é‚Šç·£é‹ç®—ç¯€é»ç¡¬é«”æ•ˆèƒ½è¶Šä¾†è¶Šå¼·ï¼Œèƒ½åšçš„äº‹æƒ…ç•¶ç„¶ä¹Ÿå°±å¯ä»¥è¶Šä¾†è¶Šå¤šï¼Œå³ä¾¿æ˜¯å€‹åµŒå…¥å¼ä¸»æ©Ÿæ¿ï¼Œä¹Ÿæ˜¯å¯ä»¥è·‘å¾ˆå¤šæ‡‰ç”¨ç¨‹å¼çš„ Container çš„ã€‚ç„¶è€Œæœ‰äº†è¶Šä¾†è¶Šå¤šçš„å®¹å™¨ï¼Œç•¶ç„¶ä¹Ÿéœ€è¦å²å®³çš„ Container ç®¡ç†å·¥å…·ã€‚
K3s å°±æ˜¯åœ¨é€™éœ€æ±‚ä¸‹èª•ç”Ÿçš„ç”¢å“ã€‚
K3s ä»‹ç´¹ K3s ç°¡ä»‹ K3s æ˜¯ç”± Rancher Labs æ¨å‡ºçš„ è¼•é‡åŒ– Kubernetes é–‹æºå°ˆæ¡ˆï¼Œä¹Ÿæ˜¯ CNCF å®˜æ–¹èªè­‰çš„ Kubernetes ç™¼å¸ƒç‰ˆæœ¬ã€‚è€Œä¸”æ˜¯ä»¥ç”¢å“è¨­è¨ˆå‡ºç™¼çš„ï¼Œè®“ç®¡ç†è€…åœ¨è¨­å‚™è³‡æºæœ‰é™çš„ç’°å¢ƒä¸‹ï¼Œä»ç„¶å¯ä»¥è‰¯å¥½çš„é‹ä½œ Kubernetesï¼Œä¸¦ç®¡ç† containersã€‚å› æ­¤ï¼Œåœ¨é€™å„ªå‹¢ä¸‹ï¼ŒK3s å¯ä»¥å¾ˆå¥½çš„æ‡‰ç”¨åœ¨ Edge, IoT, CI, ARM ç­‰æƒ…å¢ƒã€ç’°å¢ƒä¸‹ã€‚
å®ƒæ‰€éœ€çš„ç³»çµ±è³‡æºä¸¦ä¸å¤šï¼š
 åœ¨ Server ç«¯ï¼š åªéœ€è¦ 512 MB çš„ RAM åœ¨ Node ç«¯ï¼šåªéœ€è¦ 75MB çš„ RAM Disk å¤§å°åªéœ€ 200MB  è€Œä¸”å¯ä»¥ç”¨åœ¨ x86_64, ARMv7, ARM64 ç­‰å¹³å°æ¶æ§‹ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bestsamina.github.io/posts/2019-10-10-k3s-intro-and-play/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-10-10T16:48:35+08:00" />
<meta property="article:modified_time" content="2019-10-10T16:48:35+08:00" />


  <meta itemprop="name" content="é‚Šç·£é‹ç®—ä¹‹å®¹å™¨ç®¡ç†å·¥å…· - K3s ä¹‹ä»‹ç´¹èˆ‡ç©è€">
<meta itemprop="description" content="å‰è¨€ Kubernetes æ˜¯é›²åŸç”ŸæŠ€è¡“ (cloud-native technologies)ï¼Œä¹Ÿæ˜¯é›²åŸç”Ÿè¨ˆç®— (Cloud Native Computing) é‡è¦çš„æŠ€è¡“ä¹‹ä¸€ï¼Œè€Œä¸”åœ¨ä½¿ç”¨ Kubernetes æ™‚ï¼Œæ‡‰ç”¨çš„ç¡¬é«”è³‡æºé€šå¸¸ä¹Ÿæ¯”è¼ƒå¥½ã€‚ç„¶è€Œï¼Œ å®¹å™¨ (Container) æŠ€è¡“çš„å´›èµ·ï¼Œä¹Ÿå¸¶å‹•äº†é‚Šç·£é‹ç®— (Edge computing) å°å…¥ Container æŠ€è¡“çš„é¢¨æ½®ã€‚
é‚Šç·£é‹ç®—é¡§åæ€ç¾©å°±æ˜¯å°‡æ‡‰ç”¨ç¨‹å¼ç­‰æœå‹™é‹ç®—ï¼Œç”±ç¶²è·¯ä¸­å¿ƒç¯€é»ï¼Œç§»å¾€ç¶²è·¯é‚è¼¯ä¸Šçš„é‚Šç·£ç¯€é»ä¾†è™•ç†ã€‚ä¹Ÿå°±æ˜¯å¾ç¶²è·¯ä¸­å¿ƒç¯€é»è™•ç†å¤§å‹æœå‹™ä¾†åˆ†è§£ï¼Œåˆ‡å‰²æˆæ›´å°ã€æ›´å®¹æ˜“ç®¡ç†çš„éƒ¨ä»½ï¼Œåˆ†æ•£åˆ°é‚Šç·£ç¯€é»å»è™•ç†ã€‚å¯ä»¥æƒ³åƒï¼Œå¦‚æœç¶²è·¯ä¸­å¿ƒç¯€é»çš„è§’è‰²å¦‚åŒç¸½ç¶“ç†ï¼Œé‚Šç·£ç¯€é»çš„è§’è‰²å¦‚åŒéƒ¨é–€ç¶“ç†ï¼Œè€Œçµ‚ç«¯è£ç½®çš„è§’è‰²å¦‚åŒåŸºå±¤å“¡å·¥ã€‚åœ¨é€™æ¶æ§‹ä¸‹ï¼Œæƒ³ç•¶ç„¶è€³å°±æ˜¯å€‹åˆ†æ•£å¼æ¶æ§‹ï¼Œè€Œé‚Šç·£ç¯€é»å› ç‚ºæ›´æ¥è¿‘æ–¼çµ‚ç«¯è£ç½®ï¼Œå› æ­¤å¯ä»¥åŠ å¿«è³‡æ–™çš„è™•ç†èˆ‡å‚³é€é€Ÿåº¦ï¼Œæ¸›å°‘å»¶é²ã€‚å¦‚åŒåŸºå±¤å“¡å·¥ç›´ç¶“å›å ±éƒ¨é–€ç¶“ç†ï¼Œè€Œé‡è¦çš„è³‡è¨Šï¼Œéƒ¨é–€ç¶“ç†å†å›å ±çµ¦ç¸½ç¶“ç†ä¸€æ¨£ã€‚ä¹Ÿå› æ­¤åœ¨é‚Šç·£é‹ç®—çš„æ‡‰ç”¨ä¸­ä¸€ç›´éƒ½æœ‰é‡è¦çš„æ‡‰ç”¨å ´æ™¯åœ¨ï¼Œä¾‹å¦‚å¤§å®¶å¸¸è½åˆ°çš„ IoTã€‚
ç•¶é‚Šç·£é‹ç®—ç¯€é»ç¡¬é«”æ•ˆèƒ½è¶Šä¾†è¶Šå¼·ï¼Œèƒ½åšçš„äº‹æƒ…ç•¶ç„¶ä¹Ÿå°±å¯ä»¥è¶Šä¾†è¶Šå¤šï¼Œå³ä¾¿æ˜¯å€‹åµŒå…¥å¼ä¸»æ©Ÿæ¿ï¼Œä¹Ÿæ˜¯å¯ä»¥è·‘å¾ˆå¤šæ‡‰ç”¨ç¨‹å¼çš„ Container çš„ã€‚ç„¶è€Œæœ‰äº†è¶Šä¾†è¶Šå¤šçš„å®¹å™¨ï¼Œç•¶ç„¶ä¹Ÿéœ€è¦å²å®³çš„ Container ç®¡ç†å·¥å…·ã€‚
K3s å°±æ˜¯åœ¨é€™éœ€æ±‚ä¸‹èª•ç”Ÿçš„ç”¢å“ã€‚
K3s ä»‹ç´¹ K3s ç°¡ä»‹ K3s æ˜¯ç”± Rancher Labs æ¨å‡ºçš„ è¼•é‡åŒ– Kubernetes é–‹æºå°ˆæ¡ˆï¼Œä¹Ÿæ˜¯ CNCF å®˜æ–¹èªè­‰çš„ Kubernetes ç™¼å¸ƒç‰ˆæœ¬ã€‚è€Œä¸”æ˜¯ä»¥ç”¢å“è¨­è¨ˆå‡ºç™¼çš„ï¼Œè®“ç®¡ç†è€…åœ¨è¨­å‚™è³‡æºæœ‰é™çš„ç’°å¢ƒä¸‹ï¼Œä»ç„¶å¯ä»¥è‰¯å¥½çš„é‹ä½œ Kubernetesï¼Œä¸¦ç®¡ç† containersã€‚å› æ­¤ï¼Œåœ¨é€™å„ªå‹¢ä¸‹ï¼ŒK3s å¯ä»¥å¾ˆå¥½çš„æ‡‰ç”¨åœ¨ Edge, IoT, CI, ARM ç­‰æƒ…å¢ƒã€ç’°å¢ƒä¸‹ã€‚
å®ƒæ‰€éœ€çš„ç³»çµ±è³‡æºä¸¦ä¸å¤šï¼š
 åœ¨ Server ç«¯ï¼š åªéœ€è¦ 512 MB çš„ RAM åœ¨ Node ç«¯ï¼šåªéœ€è¦ 75MB çš„ RAM Disk å¤§å°åªéœ€ 200MB  è€Œä¸”å¯ä»¥ç”¨åœ¨ x86_64, ARMv7, ARM64 ç­‰å¹³å°æ¶æ§‹ã€‚"><meta itemprop="datePublished" content="2019-10-10T16:48:35+08:00" />
<meta itemprop="dateModified" content="2019-10-10T16:48:35+08:00" />
<meta itemprop="wordCount" content="876">
<meta itemprop="keywords" content="Kubernetes,K8s,K3s,cloud-native,container," />
</head>
<body>

  <header style="background-image:linear-gradient(
      rgba(0,0,0,0.4),rgba(0,0,0,0.4)
    ),url(&#39;https://bestsamina.github.io/images/default-sidebar.jpg&#39;)">
  <div class="intro">
    <div class="logo-container">
      <a href="/">
        <img src='https://bestsamina.github.io/images/person.jpg' alt="Profile çµ‚ç«¯æ©Ÿçš„è¶…ç‹‚å·¥å…·-TMUX èˆ‡æŒ‡ä»¤æ•´ç†" class="rounded-logo">
      </a>
    </div>
    <h3>Hi, I'm Samina ğŸ‘‹</h3>
    <h4>This is my Life & Technological Journey</h4>
    <div class="menu">
      

        <p>
            <a href="/posts/">
                Post
            </a>
        </p>

        <p>
            <a href="/about/">
                About
            </a>
        </p>

        <p>
            <a href="/tags/">
                Tags
            </a>
        </p>

        <p>
            <a href="/categories/">
                Categories
            </a>
        </p>

        <p>
            <a href="/page/awesome-blogs/">
                Awesome-blogs
            </a>
        </p>

      
    </div>
  </div>

  <div class="socials">
      
  
    <a href="https://github.com/sufuf3" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M102.679 0H12.32C5.52 0 0 5.519 0 12.321v90.358C0 109.48 5.519 115 12.321 115h90.358c6.802 0 12.321-5.519 12.321-12.321V12.32C115 5.52 109.481 0 102.679 0zM71.182 98.494c-2.156.385-2.952-.95-2.952-2.053 0-1.386.051-8.471.051-14.195 0-4.005-1.335-6.546-2.9-7.881C74.878 73.313 84.89 72.003 84.89 55.6c0-4.671-1.669-7.007-4.39-10.01.436-1.105 1.9-5.648-.436-11.552-3.568-1.104-11.731 4.595-11.731 4.595-3.389-.95-7.06-1.438-10.679-1.438-3.62 0-7.29.488-10.679 1.438 0 0-8.163-5.699-11.73-4.595-2.337 5.878-.899 10.422-.437 11.551-2.72 3.004-4.004 5.34-4.004 10.011 0 16.326 9.574 17.712 19.072 18.765-1.232 1.104-2.336 3.003-2.72 5.724-2.44 1.104-8.677 3.004-12.4-3.568-2.335-4.056-6.545-4.39-6.545-4.39-4.159-.05-.282 2.619-.282 2.619 2.772 1.283 4.723 6.212 4.723 6.212 2.49 7.624 14.4 5.057 14.4 5.057 0 3.568.052 9.37.052 10.422 0 1.104-.77 2.438-2.952 2.053C27.21 92.821 15.35 76.701 15.35 57.86c0-23.564 18.02-41.456 41.585-41.456s42.663 17.892 42.663 41.456c.026 18.842-11.474 34.988-28.416 40.635zM46 82.81c-.488.103-.95-.102-1.001-.436-.051-.385.282-.719.77-.822.488-.05.95.154 1.001.488.077.334-.257.668-.77.77zm-2.439-.23c0 .333-.385.615-.898.615-.565.052-.95-.23-.95-.616 0-.333.385-.616.899-.616.487-.051.95.231.95.616zm-3.516-.283c-.103.334-.616.488-1.053.334-.488-.103-.821-.488-.719-.822.103-.334.617-.488 1.053-.385.513.154.847.54.719.873zm-3.158-1.386c-.23.282-.718.23-1.104-.154-.385-.334-.487-.822-.23-1.053.23-.282.718-.23 1.103.154.334.334.462.847.231 1.053zm-2.336-2.336c-.23.154-.667 0-.95-.385-.282-.385-.282-.822 0-1.001.283-.231.72-.052.95.333.283.385.283.847 0 1.053zm-1.668-2.49c-.231.23-.616.103-.899-.154-.282-.334-.333-.719-.102-.899.23-.23.616-.102.898.154.282.334.334.72.103.899zm-1.72-1.9c-.103.231-.436.283-.719.103-.334-.154-.488-.436-.385-.667.103-.154.385-.231.719-.103.334.18.488.462.385.667z"/>
  
  </svg>
</div>
</a>
  

  
    <a href="https://gitlab.com/sufuf3" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M23.76 5.544c-.693-1.991-3.512-1.991-4.228 0L6.892 44.653h29.532c-.022 0-12.663-39.11-12.663-39.11zM.426 64.34c-.582 1.79.067 3.782 1.589 4.923l55.464 41.167-50.61-65.778L.426 64.34zm35.977-19.688L57.5 110.43l21.098-65.778H36.402zm78.173 19.688l-6.444-19.688L57.5 110.43l55.464-41.167a4.475 4.475 0 0 0 1.61-4.923zM95.468 5.544c-.694-1.991-3.513-1.991-4.229 0L78.576 44.653h29.533L95.468 5.543z" />
  
  </svg>
</div>
</a>
  

  
    <a href="https://medium.com/@sufuf3149" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M0 0v115h115V0H0zm95.542 27.235l-6.16 5.905a1.81 1.81 0 0 0-.693 1.72v43.458c-.103.667.154 1.335.693 1.72l6.032 5.904v1.31h-30.29v-1.259l6.238-6.058c.616-.616.616-.795.616-1.72V43.074L54.625 87.123h-2.336l-20.202-44.05v29.52c-.18 1.233.257 2.49 1.13 3.39l8.111 9.83v1.31H18.277v-1.31l8.111-9.83a3.93 3.93 0 0 0 1.053-3.39v-34.14a2.93 2.93 0 0 0-.976-2.516l-7.213-8.702v-1.309h22.41l17.301 37.991 15.222-37.965h21.357v1.283z"/>
  
  </svg>
</div>
</a>
  

  
    <a href="https://twitter.com/sufuf3149" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M102.679 0H12.32C5.52 0 0 5.519 0 12.321v90.358C0 109.48 5.519 115 12.321 115h90.358c6.802 0 12.321-5.519 12.321-12.321V12.32C115 5.52 109.481 0 102.679 0zM90.126 40.763c.051.72.051 1.464.051 2.182 0 22.256-16.942 47.9-47.9 47.9-9.548 0-18.404-2.772-25.848-7.547 1.36.154 2.67.205 4.055.205 7.881 0 15.12-2.67 20.895-7.187-7.392-.154-13.604-5.006-15.735-11.68 2.593.385 4.929.385 7.598-.308a16.837 16.837 0 0 1-13.476-16.531v-.205a16.824 16.824 0 0 0 7.598 2.13 16.8 16.8 0 0 1-7.496-14.016c0-3.131.822-6.006 2.285-8.496a47.803 47.803 0 0 0 34.705 17.61c-2.387-11.424 6.161-20.69 16.429-20.69 4.851 0 9.215 2.027 12.296 5.313a32.99 32.99 0 0 0 10.678-4.056 16.792 16.792 0 0 1-7.393 9.267c3.389-.36 6.674-1.31 9.703-2.618a35.437 35.437 0 0 1-8.445 8.727z"/>
  
  </svg>
</div>
</a>
  

  </div>
</header>

<div class="mobile-header">
  <p> Samina Website </p>
  <div class="hamburger">
    <div class="bar"></div>
    <div class="bar"></div>
    <div class="bar"></div>
  </div>
</div>

<div class="overlay-menu">
  <header>
    <div class="intro">
      <div class="logo-container">
        <a href="/">
          <img src='https://bestsamina.github.io/images/person.jpg' alt="Profile çµ‚ç«¯æ©Ÿçš„è¶…ç‹‚å·¥å…·-TMUX èˆ‡æŒ‡ä»¤æ•´ç†" class="rounded-logo">
        </a>
      </div>
      <h3>Hi, I'm Samina ğŸ‘‹</h3>
      <h4>This is my Life & Technological Journey</h4>
      <div class="menu">
        

        <p>
            <a href="/posts/">
                Post
            </a>
        </p>

        <p>
            <a href="/about/">
                About
            </a>
        </p>

        <p>
            <a href="/tags/">
                Tags
            </a>
        </p>

        <p>
            <a href="/categories/">
                Categories
            </a>
        </p>

        <p>
            <a href="/page/awesome-blogs/">
                Awesome-blogs
            </a>
        </p>

        
      </div>
    </div>

    <div class="socials">
        
  
    <a href="https://github.com/sufuf3" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M102.679 0H12.32C5.52 0 0 5.519 0 12.321v90.358C0 109.48 5.519 115 12.321 115h90.358c6.802 0 12.321-5.519 12.321-12.321V12.32C115 5.52 109.481 0 102.679 0zM71.182 98.494c-2.156.385-2.952-.95-2.952-2.053 0-1.386.051-8.471.051-14.195 0-4.005-1.335-6.546-2.9-7.881C74.878 73.313 84.89 72.003 84.89 55.6c0-4.671-1.669-7.007-4.39-10.01.436-1.105 1.9-5.648-.436-11.552-3.568-1.104-11.731 4.595-11.731 4.595-3.389-.95-7.06-1.438-10.679-1.438-3.62 0-7.29.488-10.679 1.438 0 0-8.163-5.699-11.73-4.595-2.337 5.878-.899 10.422-.437 11.551-2.72 3.004-4.004 5.34-4.004 10.011 0 16.326 9.574 17.712 19.072 18.765-1.232 1.104-2.336 3.003-2.72 5.724-2.44 1.104-8.677 3.004-12.4-3.568-2.335-4.056-6.545-4.39-6.545-4.39-4.159-.05-.282 2.619-.282 2.619 2.772 1.283 4.723 6.212 4.723 6.212 2.49 7.624 14.4 5.057 14.4 5.057 0 3.568.052 9.37.052 10.422 0 1.104-.77 2.438-2.952 2.053C27.21 92.821 15.35 76.701 15.35 57.86c0-23.564 18.02-41.456 41.585-41.456s42.663 17.892 42.663 41.456c.026 18.842-11.474 34.988-28.416 40.635zM46 82.81c-.488.103-.95-.102-1.001-.436-.051-.385.282-.719.77-.822.488-.05.95.154 1.001.488.077.334-.257.668-.77.77zm-2.439-.23c0 .333-.385.615-.898.615-.565.052-.95-.23-.95-.616 0-.333.385-.616.899-.616.487-.051.95.231.95.616zm-3.516-.283c-.103.334-.616.488-1.053.334-.488-.103-.821-.488-.719-.822.103-.334.617-.488 1.053-.385.513.154.847.54.719.873zm-3.158-1.386c-.23.282-.718.23-1.104-.154-.385-.334-.487-.822-.23-1.053.23-.282.718-.23 1.103.154.334.334.462.847.231 1.053zm-2.336-2.336c-.23.154-.667 0-.95-.385-.282-.385-.282-.822 0-1.001.283-.231.72-.052.95.333.283.385.283.847 0 1.053zm-1.668-2.49c-.231.23-.616.103-.899-.154-.282-.334-.333-.719-.102-.899.23-.23.616-.102.898.154.282.334.334.72.103.899zm-1.72-1.9c-.103.231-.436.283-.719.103-.334-.154-.488-.436-.385-.667.103-.154.385-.231.719-.103.334.18.488.462.385.667z"/>
  
  </svg>
</div>
</a>
  

  
    <a href="https://gitlab.com/sufuf3" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M23.76 5.544c-.693-1.991-3.512-1.991-4.228 0L6.892 44.653h29.532c-.022 0-12.663-39.11-12.663-39.11zM.426 64.34c-.582 1.79.067 3.782 1.589 4.923l55.464 41.167-50.61-65.778L.426 64.34zm35.977-19.688L57.5 110.43l21.098-65.778H36.402zm78.173 19.688l-6.444-19.688L57.5 110.43l55.464-41.167a4.475 4.475 0 0 0 1.61-4.923zM95.468 5.544c-.694-1.991-3.513-1.991-4.229 0L78.576 44.653h29.533L95.468 5.543z" />
  
  </svg>
</div>
</a>
  

  
    <a href="https://medium.com/@sufuf3149" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M0 0v115h115V0H0zm95.542 27.235l-6.16 5.905a1.81 1.81 0 0 0-.693 1.72v43.458c-.103.667.154 1.335.693 1.72l6.032 5.904v1.31h-30.29v-1.259l6.238-6.058c.616-.616.616-.795.616-1.72V43.074L54.625 87.123h-2.336l-20.202-44.05v29.52c-.18 1.233.257 2.49 1.13 3.39l8.111 9.83v1.31H18.277v-1.31l8.111-9.83a3.93 3.93 0 0 0 1.053-3.39v-34.14a2.93 2.93 0 0 0-.976-2.516l-7.213-8.702v-1.309h22.41l17.301 37.991 15.222-37.965h21.357v1.283z"/>
  
  </svg>
</div>
</a>
  

  
    <a href="https://twitter.com/sufuf3149" class="social-link" target="_blank" rel="noopener" ><div class="icon">
  <svg width="35px" height="35px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M102.679 0H12.32C5.52 0 0 5.519 0 12.321v90.358C0 109.48 5.519 115 12.321 115h90.358c6.802 0 12.321-5.519 12.321-12.321V12.32C115 5.52 109.481 0 102.679 0zM90.126 40.763c.051.72.051 1.464.051 2.182 0 22.256-16.942 47.9-47.9 47.9-9.548 0-18.404-2.772-25.848-7.547 1.36.154 2.67.205 4.055.205 7.881 0 15.12-2.67 20.895-7.187-7.392-.154-13.604-5.006-15.735-11.68 2.593.385 4.929.385 7.598-.308a16.837 16.837 0 0 1-13.476-16.531v-.205a16.824 16.824 0 0 0 7.598 2.13 16.8 16.8 0 0 1-7.496-14.016c0-3.131.822-6.006 2.285-8.496a47.803 47.803 0 0 0 34.705 17.61c-2.387-11.424 6.161-20.69 16.429-20.69 4.851 0 9.215 2.027 12.296 5.313a32.99 32.99 0 0 0 10.678-4.056 16.792 16.792 0 0 1-7.393 9.267c3.389-.36 6.674-1.31 9.703-2.618a35.437 35.437 0 0 1-8.445 8.727z"/>
  
  </svg>
</div>
</a>
  

    </div>
  </header>
</div>

  <div class="content-wrapper">
    
      <div class="breadcrumb">
  





<span >
  <a href="https://bestsamina.github.io/">Home</a>
   / 
</span>


<span >
  <a href="https://bestsamina.github.io/posts/">POST</a>
   / 
</span>


<span  class="active">
  <a href="https://bestsamina.github.io/posts/2019-10-10-k3s-intro-and-play/">é‚Šç·£é‹ç®—ä¹‹å®¹å™¨ç®¡ç†å·¥å…· - K3s ä¹‹ä»‹ç´¹èˆ‡ç©è€</a>
  
</span>

</div>

    
    <main id="content" class="posts">

<h1>é‚Šç·£é‹ç®—ä¹‹å®¹å™¨ç®¡ç†å·¥å…· - K3s ä¹‹ä»‹ç´¹èˆ‡ç©è€</h1>


<div class="reading-time">
  <div class="icon">
  <svg width="18px" height="18px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M57.5 11C29.05 11 6 34.05 6 62.5S29.05 114 57.5 114 109 90.95 109 62.5 85.95 11 57.5 11zm0 93.032c-22.947 0-41.532-18.585-41.532-41.532 0-22.947 18.585-41.532 41.532-41.532 22.947 0 41.532 18.585 41.532 41.532 0 22.947-18.585 41.532-41.532 41.532zm12.833-21.68L52.703 69.54a2.508 2.508 0 0 1-1.018-2.015V33.427a2.5 2.5 0 0 1 2.492-2.492h6.646a2.5 2.5 0 0 1 2.492 2.492v29.426l13.871 10.092c1.122.81 1.35 2.368.54 3.49l-3.904 5.377a2.51 2.51 0 0 1-3.489.54z"/>
  
  </svg>
</div>

  <span>5 minutes</span>
</div>

<div class="published-date">
  <div class="icon">
  <svg width="18px" height="18px" viewBox="0 0 115 115" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
  
  <path d="M77.577 51.23a1.807 1.807 0 0 0-2.2.342l-27.562 27.79a1.807 1.807 0 0 1-2.2.342l-14.008-9.702a1.807 1.807 0 0 0-2.2.342l-1.952 1.968c-.287.22-.456.568-.455.936.001.37.172.716.46.934L45.637 86.77a1.807 1.807 0 0 0 2.2-.342l31.709-31.97c.287-.22.456-.567.455-.936a1.175 1.175 0 0 0-.46-.933l-1.963-1.36z"/><path d="M97.304 20H80.512c-.041.34-.063.683-.064 1.026a5.986 5.986 0 0 0 1.256 4.1c.054.003.103.02.157.025a4.881 4.881 0 0 1 1.865-.025c3.05.562 4.984 3.907 4.32 7.47-.666 3.563-3.678 5.996-6.728 5.433a4.932 4.932 0 0 1-2.437-1.258c-6.018-1.378-10.445-7.795-10.445-15.745 0-.347.023-.685.04-1.026H34.579c-.041.34-.063.683-.064 1.026a5.986 5.986 0 0 0 1.256 4.1c.054.003.103.02.157.025a4.881 4.881 0 0 1 1.865-.025c3.05.562 4.984 3.907 4.32 7.47-.666 3.563-3.678 5.996-6.728 5.433a4.932 4.932 0 0 1-2.437-1.258c-6.018-1.378-10.445-7.795-10.445-15.745 0-.22.019-.434.025-.652a9.788 9.788 0 0 0-5.697 4.471 9.683 9.683 0 0 0-2.65 4.764L1.158 92.871c-.965 4.689 2.6 8.503 7.948 8.503h6.334v2.673c-.077 5.41 4.263 9.861 9.705 9.953h72.16c5.438-.095 9.774-4.546 9.694-9.953V29.953c.08-5.407-4.256-9.858-9.695-9.953zM10.078 96.653c-2.378 0-3.964-1.697-3.535-3.782L16.637 43.84h80.787L87.331 92.871a5.254 5.254 0 0 1-5.091 3.782H10.078zm91.535 7.394c.036 2.403-1.891 4.382-4.308 4.424h-72.16c-2.42-.04-4.352-2.018-4.32-4.424v-2.673h60.443c5.348 0 10.484-3.814 11.449-8.503l8.897-43.215v54.391z"/><path d="M34.814 33c1.243 0 2.251-1.057 2.251-2.36 0-1.305-1.008-2.362-2.25-2.362-2.04 0-4.313-3.194-4.313-7.778s2.272-7.778 4.312-7.778c1.227 0 2.536 1.163 3.386 3.084H43C41.716 11.19 38.578 8 34.814 8 29.871 8 26 13.49 26 20.5c0 7.009 3.871 12.5 8.814 12.5z"/>
  
  </svg>
</div>

  <span>October 10, 2019</span>
</div>
<div class="page-tag">
  <div class="page-tag">Category: </div>
    
      <div class="page-tag" id="tags">
        
          <div class="page-tag">
            <a href="https://bestsamina.github.io/categories/cloud-native">cloud-native</a>
          </div>
        
      </div>
    
</div>
<div class="page-tag">
  <div class="page-tag">tags: </div>
    
      <div class="page-tag" id="tags">
        
          <div class="page-tag">
            <a href="https://bestsamina.github.io/tags/kubernetes">Kubernetes</a>
          </div>
        
          <div class="page-tag">
            <a href="https://bestsamina.github.io/tags/k8s">K8s</a>
          </div>
        
          <div class="page-tag">
            <a href="https://bestsamina.github.io/tags/k3s">K3s</a>
          </div>
        
          <div class="page-tag">
            <a href="https://bestsamina.github.io/tags/cloud-native">cloud-native</a>
          </div>
        
          <div class="page-tag">
            <a href="https://bestsamina.github.io/tags/container">container</a>
          </div>
        
      </div>
    
</div>
<br>
<span>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#å‰è¨€">å‰è¨€</a></li>
    <li><a href="#k3s-ä»‹ç´¹">K3s ä»‹ç´¹</a>
      <ul>
        <li><a href="#k3s-ç°¡ä»‹">K3s ç°¡ä»‹</a></li>
        <li><a href="#k3s-æ¶æ§‹">K3s æ¶æ§‹</a></li>
      </ul>
    </li>
    <li><a href="#éƒ¨ç½²-k3s-cluster">éƒ¨ç½² K3s cluster</a>
      <ul>
        <li><a href="#1-é¦–å…ˆåœ¨-master-ä¸Šå®‰è£-k3s-server">1. é¦–å…ˆåœ¨ Master ä¸Šå®‰è£ K3s Server</a></li>
        <li><a href="#2-å®‰è£-k3s-node">2. å®‰è£ K3s Node</a></li>
      </ul>
    </li>
    <li><a href="#å¿«é€Ÿå®‰è£æ³•">å¿«é€Ÿå®‰è£æ³•</a></li>
    <li><a href="#åŠŸèƒ½é©—è­‰">åŠŸèƒ½é©—è­‰</a></li>
    <li><a href="#ç§»é™¤å®‰è£">ç§»é™¤å®‰è£</a></li>
    <li><a href="#åœ¨-arm-ä¸Šé¢éƒ¨ç½²-k3s-cluster">åœ¨ ARM ä¸Šé¢éƒ¨ç½² K3s Cluster</a></li>
    <li><a href="#çµèª">çµèª</a></li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav>
</span>


<h2 id="å‰è¨€">å‰è¨€</h2>
<p>Kubernetes æ˜¯é›²åŸç”ŸæŠ€è¡“ (cloud-native technologies)ï¼Œä¹Ÿæ˜¯é›²åŸç”Ÿè¨ˆç®— (Cloud Native Computing) é‡è¦çš„æŠ€è¡“ä¹‹ä¸€ï¼Œè€Œä¸”åœ¨ä½¿ç”¨ Kubernetes æ™‚ï¼Œæ‡‰ç”¨çš„ç¡¬é«”è³‡æºé€šå¸¸ä¹Ÿæ¯”è¼ƒå¥½ã€‚ç„¶è€Œï¼Œ å®¹å™¨ (Container) æŠ€è¡“çš„å´›èµ·ï¼Œä¹Ÿå¸¶å‹•äº†é‚Šç·£é‹ç®— (Edge computing) å°å…¥ Container æŠ€è¡“çš„é¢¨æ½®ã€‚</p>
<p>é‚Šç·£é‹ç®—é¡§åæ€ç¾©å°±æ˜¯å°‡æ‡‰ç”¨ç¨‹å¼ç­‰æœå‹™é‹ç®—ï¼Œç”±ç¶²è·¯ä¸­å¿ƒç¯€é»ï¼Œç§»å¾€ç¶²è·¯é‚è¼¯ä¸Šçš„é‚Šç·£ç¯€é»ä¾†è™•ç†ã€‚ä¹Ÿå°±æ˜¯å¾ç¶²è·¯ä¸­å¿ƒç¯€é»è™•ç†å¤§å‹æœå‹™ä¾†åˆ†è§£ï¼Œåˆ‡å‰²æˆæ›´å°ã€æ›´å®¹æ˜“ç®¡ç†çš„éƒ¨ä»½ï¼Œåˆ†æ•£åˆ°é‚Šç·£ç¯€é»å»è™•ç†ã€‚å¯ä»¥æƒ³åƒï¼Œå¦‚æœç¶²è·¯ä¸­å¿ƒç¯€é»çš„è§’è‰²å¦‚åŒç¸½ç¶“ç†ï¼Œé‚Šç·£ç¯€é»çš„è§’è‰²å¦‚åŒéƒ¨é–€ç¶“ç†ï¼Œè€Œçµ‚ç«¯è£ç½®çš„è§’è‰²å¦‚åŒåŸºå±¤å“¡å·¥ã€‚åœ¨é€™æ¶æ§‹ä¸‹ï¼Œæƒ³ç•¶ç„¶è€³å°±æ˜¯å€‹åˆ†æ•£å¼æ¶æ§‹ï¼Œè€Œé‚Šç·£ç¯€é»å› ç‚ºæ›´æ¥è¿‘æ–¼çµ‚ç«¯è£ç½®ï¼Œå› æ­¤å¯ä»¥åŠ å¿«è³‡æ–™çš„è™•ç†èˆ‡å‚³é€é€Ÿåº¦ï¼Œæ¸›å°‘å»¶é²ã€‚å¦‚åŒåŸºå±¤å“¡å·¥ç›´ç¶“å›å ±éƒ¨é–€ç¶“ç†ï¼Œè€Œé‡è¦çš„è³‡è¨Šï¼Œéƒ¨é–€ç¶“ç†å†å›å ±çµ¦ç¸½ç¶“ç†ä¸€æ¨£ã€‚ä¹Ÿå› æ­¤åœ¨é‚Šç·£é‹ç®—çš„æ‡‰ç”¨ä¸­ä¸€ç›´éƒ½æœ‰é‡è¦çš„æ‡‰ç”¨å ´æ™¯åœ¨ï¼Œä¾‹å¦‚å¤§å®¶å¸¸è½åˆ°çš„ IoTã€‚</p>
<p>ç•¶é‚Šç·£é‹ç®—ç¯€é»ç¡¬é«”æ•ˆèƒ½è¶Šä¾†è¶Šå¼·ï¼Œèƒ½åšçš„äº‹æƒ…ç•¶ç„¶ä¹Ÿå°±å¯ä»¥è¶Šä¾†è¶Šå¤šï¼Œå³ä¾¿æ˜¯å€‹åµŒå…¥å¼ä¸»æ©Ÿæ¿ï¼Œä¹Ÿæ˜¯å¯ä»¥è·‘å¾ˆå¤šæ‡‰ç”¨ç¨‹å¼çš„ Container çš„ã€‚ç„¶è€Œæœ‰äº†è¶Šä¾†è¶Šå¤šçš„å®¹å™¨ï¼Œç•¶ç„¶ä¹Ÿéœ€è¦å²å®³çš„ Container ç®¡ç†å·¥å…·ã€‚</p>
<p>K3s å°±æ˜¯åœ¨é€™éœ€æ±‚ä¸‹èª•ç”Ÿçš„ç”¢å“ã€‚</p>
<h2 id="k3s-ä»‹ç´¹">K3s ä»‹ç´¹</h2>
<h3 id="k3s-ç°¡ä»‹">K3s ç°¡ä»‹</h3>
<p>K3s æ˜¯ç”± Rancher Labs æ¨å‡ºçš„ è¼•é‡åŒ– Kubernetes é–‹æºå°ˆæ¡ˆï¼Œä¹Ÿæ˜¯ CNCF å®˜æ–¹èªè­‰çš„ Kubernetes ç™¼å¸ƒç‰ˆæœ¬ã€‚è€Œä¸”æ˜¯ä»¥ç”¢å“è¨­è¨ˆå‡ºç™¼çš„ï¼Œè®“ç®¡ç†è€…åœ¨è¨­å‚™è³‡æºæœ‰é™çš„ç’°å¢ƒä¸‹ï¼Œä»ç„¶å¯ä»¥è‰¯å¥½çš„é‹ä½œ Kubernetesï¼Œä¸¦ç®¡ç† containersã€‚å› æ­¤ï¼Œåœ¨é€™å„ªå‹¢ä¸‹ï¼ŒK3s å¯ä»¥å¾ˆå¥½çš„æ‡‰ç”¨åœ¨ Edge, IoT, CI, ARM ç­‰æƒ…å¢ƒã€ç’°å¢ƒä¸‹ã€‚<br>
å®ƒæ‰€éœ€çš„ç³»çµ±è³‡æºä¸¦ä¸å¤šï¼š</p>
<ul>
<li>åœ¨ Server ç«¯ï¼š åªéœ€è¦ 512 MB çš„ RAM</li>
<li>åœ¨ Node ç«¯ï¼šåªéœ€è¦ 75MB çš„ RAM</li>
<li>Disk å¤§å°åªéœ€ 200MB</li>
</ul>
<p>è€Œä¸”å¯ä»¥ç”¨åœ¨ x86_64, ARMv7, ARM64 ç­‰å¹³å°æ¶æ§‹ã€‚</p>
<h3 id="k3s-æ¶æ§‹">K3s æ¶æ§‹</h3>
<p>K3s æ˜¯å°‡ Kubernetes çš„å…ƒä»¶ (åŒ…å« kube-apiserver, kube-controller-manager, kube-scheduler, kubelet, kube-proxy) æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œä¸¦ä»¥ server å’Œ agent çš„ model å½¢å¼å‘ˆç¾ã€‚</p>
<p>å› æ­¤ K3s çš„æ¶æ§‹å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ï¼Œ å¦‚åœ–æ‰€ç¤ºï¼Œå¯ä»¥åˆ°æœ‰ Server èˆ‡ Agentã€‚</p>
<ul>
<li>Server: (Kubernetes ç®¡ç†å…ƒä»¶ + SQLite + Tunnel Proxy)
<ul>
<li>API Server: ä¾†æä¾› API çš„ï¼Œä¸¦ä¸”æœƒå°‡è³‡æ–™å­˜åˆ°è³‡æ–™åº«(é è¨­ä½¿ç”¨ SQLite)ã€‚</li>
<li>SQLite: æ˜¯å­˜æ”¾ Cluster status è³‡æ–™çš„åœ°æ–¹ã€‚åŒæ™‚ä¹Ÿæœ‰æ”¯æ´ etcd, Mysql, Postgres (v0.9.1 ref: <a href="https://rancher.com/docs/k3s/latest/en/installation/#server-options">server-options K3S_STORAGE_ENDPOINT</a>)</li>
<li>Scheduler: å’Œ Kubernetes ä¸€æ¨£æœ‰é¸ Node run pod çš„åŠŸèƒ½ã€‚</li>
<li>Controller Manager: ç®—æ˜¯ K3s çš„å¾Œç«¯ç¨‹å¼ï¼Œæ˜¯è™•ç† Kubernetes resource çš„ controller managerã€‚</li>
</ul>
</li>
<li>Agent: (Kubernetes data plan å…ƒä»¶ + Tunnel Proxy)
<ul>
<li>Kube-proxy: å°±æ˜¯åš forwrading ç”¨çš„ã€‚</li>
<li>Flannel: Pod æºé€šç”¨çš„ç¶²è·¯ã€‚</li>
<li>Kubelet: å•Ÿå‹• container ç”¨ã€‚</li>
</ul>
</li>
<li>Tunnel Proxy of Server &amp; Agent:
<ul>
<li>åœ¨ Server çš„ <a href="https://github.com/rancher/k3s/blob/v0.9.1/pkg/daemons/control/tunnel.go"><code>pkg/daemons/control/tunnel.go</code></a> ç¨‹å¼ä¸­æœƒçœ‹åˆ° <code>setupTunnel</code>ï¼Œè€Œåœ¨ç¨‹å¼ä¸­ä¹Ÿæœƒçœ‹åˆ° <code>setupProxyDialer</code> ï¼Œæ‰€ä»¥å¯æƒ³è€ŒçŸ¥ï¼Œåœ¨ Server ç«¯ï¼Œæœƒæœ‰ Tunnel å’Œ Proxy çš„åŠŸèƒ½ã€‚</li>
<li>è€Œåœ¨åœ¨åœ–ä¸­ï¼Œå¯ä»¥çœ‹åˆ° Agent çš„ kubelet æœƒå‚³è³‡æ–™çµ¦ Tunnel Proxy ï¼Œé‚£æ˜¯æ€éº¼å‚³çš„ï¼Ÿåœ¨ <a href="https://github.com/rancher/k3s/blob/v0.9.1/pkg/agent/tunnel/tunnel.go#L168"><code>v0.9.1/pkg/agent/tunnel/tunnel.go#L168</code></a> æˆ‘å€‘ä¹Ÿçœ‹åˆ°å…¶å¯¦ agent ç¨‹å¼ä¹Ÿæ˜¯é€é wss å”å®šæ–¹å¼é€²è¡Œè³‡æ–™å‚³è¼¸å’Œ Server ç«¯æºé€šï¼Œå› æ­¤é€™æ¨£å°±å¯ä»¥ä¸²èµ·ä¾†èªªï¼ŒServer å’Œ Agent ä¹‹é–“æ˜¯æ€éº¼æºé€šäº†ã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://k3s.io/images/how-it-works-k3s.svg" alt=""></p>
<h2 id="éƒ¨ç½²-k3s-cluster">éƒ¨ç½² K3s cluster</h2>
<p>åœ¨éƒ¨ç½² Cluster ä¹‹å‰éœ€è¦å…ˆæº–å‚™çš„ç’°å¢ƒå¦‚ä¸‹ï¼š<br>
å…©å° Host (VM æˆ–ä¸»æ©Ÿ) ï¼Œ Server VM çš„ RAM è‡³å°‘éœ€è¦ 512 MBï¼ŒWork Node VM çš„ RAM è‡³å°‘éœ€è¦ 75MBï¼Œä¸¦ä¸”å…©å°ä¸»æ©Ÿéƒ½å·²ç¶“å®‰è£å¥½ Docker äº†ã€‚</p>
<h3 id="1-é¦–å…ˆåœ¨-master-ä¸Šå®‰è£-k3s-server">1. é¦–å…ˆåœ¨ Master ä¸Šå®‰è£ K3s Server</h3>
<p>åˆ‡æ›åˆ° root ä½¿ç”¨è€…ï¼Œä¸¦åŸ·è¡Œä»¥ä¸‹çš„ Command</p>
<pre tabindex="0"><code>IPADDR=$(ip a show enp0s8 | grep &#34;inet &#34; | awk &#39;{print $2}&#39; | cut -d / -f1)
curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v0.9.1 INSTALL_K3S_EXEC=&#34;--docker --node-ip=${IPADDR} --flannel-iface=enp0s8 --write-kubeconfig-mode 644 --no-deploy=servicelb --no-deploy=traefik&#34; sh -
</code></pre><p>æˆ‘å€‘æœƒåŸ·è¡Œ <a href="https://get.k3s.io">https://get.k3s.io</a> é€™ç¨‹å¼è£¡é¢çš„è…³æœ¬ï¼Œè€Œå¸¶å…¥çš„ option æœ‰ï¼š</p>
<ul>
<li><code>INSTALL_K3S_VERSION</code>: æŒ‡å®šå®‰è£ K3s çš„ç‰ˆæœ¬</li>
<li><code>INSTALL_K3S_EXEC</code>: æŒ‡å®š <code>k3s server</code> åŸ·è¡Œçš„ option
<ul>
<li><code>--docker</code>: é¸ç”¨ Docker ç•¶ä½œ K3s çš„ container å¼•æ“ã€‚</li>
<li><code>--node-ip=${IPADDR}</code>: è¨­å®š Master Node çš„ IP</li>
<li><code>--flannel-iface=enp0s8</code>: è¨­å®š flannel æºé€šç”¨çš„ network interface ï¼Œè«‹è¨˜å¾—é€™é‚Šçš„ <code>enp0s8</code> æ”¹æˆè‡ªå·±ä¸»æ©Ÿçš„ network interfaceã€‚</li>
<li><code>--write-kubeconfig-mode 644</code>: è¨­å®š kubeconfig çš„æ¬Šé™ modeã€‚</li>
<li><code>--no-deploy=servicelb --no-deploy=traefik</code>: è¨­å®šä¸è¦éƒ¨ç½² packaged çš„ componentsã€‚</li>
</ul>
</li>
</ul>
<p>é€™æ¨£ K3s server å°±å®‰è£å®Œäº†ã€‚<br>
å¯ä»¥ä½¿ç”¨ <code>systemctl status k3s</code> èˆ‡ <code>journalctl -u k3s</code> æŸ¥çœ‹ K3s çš„ Service ç‹€æ…‹ã€‚</p>
<p>ä¸¦åœ¨é€²è¡Œä¸‹ä¸€æ­¥é©Ÿå‰ï¼ŒåŸ·è¡Œ <code>echo &quot;export NODE_TOKEN=$(sudo cat /var/lib/rancher/k3s/server/node-token)&quot;</code> ç´€éŒ„ Cluster Node ä¹‹é–“èªè­‰ç”¨çš„ Tokenã€‚</p>
<h3 id="2-å®‰è£-k3s-node">2. å®‰è£ K3s Node</h3>
<p>å…ˆåœ¨ <code>/etc/hosts</code> åŠ å…¥ master node èˆ‡ IP çš„å°æ‡‰ã€‚</p>
<pre tabindex="0"><code>echo &#34;$K3SMASTER_IPADDRESS       $K3SMASTER_HOSTNAME&#34; | sudo tee -a /etc/hosts
</code></pre><p>æ¥è‘—åˆ‡æ›åˆ° root ä½¿ç”¨è€…å¾Œï¼Œè²¼ä¸Šå‰›å‰› Master Node ä¸Šå–å¾—çš„èªè­‰ tokenï¼Œå¦‚ä¸‹</p>
<pre tabindex="0"><code>export NODE_TOKEN=K10571d20534c867fe6ce8d... 
</code></pre><p>ä¸¦åŸ·è¡Œä»¥ä¸‹çš„ Command ä¾†å®‰è£ K3s agent</p>
<pre tabindex="0"><code>export K3SMASTER_IPADDRESS=...
IPADDR=$(ip a show enp0s8 | grep &#34;inet &#34; | awk &#39;{print $2}&#39; | cut -d / -f1)
curl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v0.9.1 INSTALL_K3S_EXEC=&#34;--docker --node-ip=${IPADDR} --flannel-iface=enp0s8&#34; K3S_URL=https://${K3SMASTER_IPADDRESS}:6443 K3S_TOKEN=${NODE_TOKEN} sh -
</code></pre><p>åœ¨åŸ·è¡Œ <a href="https://get.k3s.io">https://get.k3s.io</a> é€™ç¨‹å¼è£¡é¢çš„è…³æœ¬ä¸­ï¼Œ<code>INSTALL_K3S_EXEC</code> è€Œå¤–å¸¶å…¥çš„ option æœ‰ï¼š</p>
<ul>
<li><code>K3S_URL</code>: æ˜¯è®“ agent çŸ¥é“ä»–è¦å’Œå“ªå€‹ server é€£ç·š</li>
<li><code>K3S_TOKEN</code>: æ˜¯ç”¨ä¾†èªè­‰ç”¨çš„</li>
</ul>
<p>é€™æ¨£ K3s agent å°±å®‰è£å®Œäº†ã€‚<br>
å¯ä»¥ä½¿ç”¨ <code>systemctl status k3s-agent</code> æŸ¥çœ‹ k3s-agent çš„ Service ç‹€æ…‹ã€‚</p>
<h2 id="å¿«é€Ÿå®‰è£æ³•">å¿«é€Ÿå®‰è£æ³•</h2>
<p>å¦‚æœä¸æƒ³è¦ä¾ç…§ä»¥ä¸Šæ–¹æ³•ä¸€æ­¥ä¸€æ­¥æ“ä½œçš„è©±ï¼Œä¹Ÿå¯ä»¥åƒè€ƒ <a href="https://github.com/sufuf3/k3s-lab">https://github.com/sufuf3/k3s-lab</a> repository ä¾†å˜—è©¦å¿«é€Ÿéƒ¨ç½²èµ·ä¸€å€‹ K3s Clusterã€‚<br>
åœ¨ä½¿ç”¨ <a href="https://github.com/sufuf3/k3s-lab">https://github.com/sufuf3/k3s-lab</a> é€™å€‹æ–¹æ³•éƒ¨ç½²ï¼Œç’°å¢ƒéœ€è¦å…·å‚™ VirtualBox ä»¥åŠ Vagrant ï¼Œä¸¦ä¸”ä¸»æ©Ÿå°šæœ‰ 1.6G çš„ RAM å¯ä»¥ä½¿ç”¨ã€‚<br>
å®‰è£æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ol>
<li>åœ¨ Host ä¸Šå•Ÿå‹•å…©å° VM ä¸¦ä¸”åœ¨ Master çš„ VM ä¸­å®‰è£ K3s serverã€‚</li>
</ol>
<pre tabindex="0"><code>$ sh deploy-vagrant.sh
</code></pre><ol start="2">
<li>åœ¨ç¬¬ä¸€æ­¥é©Ÿå®Œæˆå¾Œï¼Œæœƒå¾—åˆ°é¡ä¼¼ <code>export NODE_TOKEN=K10571d20534c867fe6ce8d...</code> çš„å­—ä¸²ï¼Œå°‡é€™å­—ä¸²è¤‡è£½å¾Œï¼Œé€é <code>vageant ssh node1</code> é€²å…¥ node çš„ VM ä¸¦ä¸”åŸ·è¡Œä»¥ä¸‹çš„æŒ‡ä»¤</li>
</ol>
<pre tabindex="0"><code>sudo su -
cd /home/vagrant/
export NODE_TOKEN=K10571d20534c867fe6ce8d... // æ˜¯è¤‡è£½çš„å­—ä¸²
sh install-k3s-node.sh ${NODE_TOKEN}
</code></pre><p>é€™æ¨£å°±å®Œæˆä»¥ä¸Šéƒ¨ç½² K3s Cluster äº†ã€‚æ¥ä¸‹ä¾†æˆ‘å€‘ä¾†é©—è­‰ K3s Cluster æ˜¯å¦æ­£å¸¸å§ï¼</p>
<h2 id="åŠŸèƒ½é©—è­‰">åŠŸèƒ½é©—è­‰</h2>
<p>é¦–å…ˆå…ˆé€²å…¥ Master Nodeï¼Œä½ å¯ä»¥é€é k3s æŒ‡ä»¤çœ‹åˆ°å®ƒæœ‰æ”¯æ´çš„ commandsï¼Œå¦‚ä¸‹ï¼Œå› æ­¤æˆ‘å€‘å¯ä»¥ç›´æ¥ä½¿ç”¨ kubectl, crictl, ctrï¼š<br>
è€Œå› ç‚ºæˆ‘å€‘ä½¿ç”¨ Docker ç‚ºæˆ‘å€‘çš„ container å¼•æ“ï¼Œæ‰€ä»¥æœ¬ç¯‡åªç”¨ kubectl ä¾†å’Œå¤§å®¶ä¸€èµ·é©—è­‰ã€‚</p>
<pre tabindex="0"><code>$ k3s -h
NAME:
   k3s - Kubernetes, but small and simple

USAGE:
   k3s [global options] command [command options] [arguments...]

VERSION:
   v0.9.1 (755bd1c6)

COMMANDS:
   server   Run management server
   agent    Run node agent
   kubectl  Run kubectl
   crictl   Run crictl
   ctr      Run ctr
   help, h  Shows a list of commands or help for one command

GLOBAL OPTIONS:
   --debug        Turn on debug logs
   --help, -h     show help
   --version, -v  print the version
</code></pre><p>æˆ‘å€‘å¯ä»¥é€é kubectl ä¾†æŸ¥çœ‹ Cluster node è³‡è¨Šèˆ‡ component çš„ç‹€æ…‹ã€‚</p>
<pre tabindex="0"><code>$ kubectl get no -o wide
NAME     STATUS   ROLES    AGE   VERSION         INTERNAL-IP     EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION      CONTAINER-RUNTIME
master   Ready    master   97m   v1.15.4-k3s.1   192.168.0.200   &lt;none&gt;        Ubuntu 18.04.3 LTS   4.15.0-64-generic   containerd://1.2.8-k3s.1
node1    Ready    worker   93m   v1.15.4-k3s.1   192.168.0.201   &lt;none&gt;        Ubuntu 18.04.3 LTS   4.15.0-64-generic   containerd://1.2.8-k3s.1

$ kubectl get componentstatus
NAME                 STATUS    MESSAGE   ERROR
scheduler            Healthy   ok
controller-manager   Healthy   ok
</code></pre><p>ä¹Ÿå¯ä»¥ç”¨ kubectl ä¾†è·‘ä¸€å€‹ deployment ä¾†å•Ÿå‹•ä¸€å€‹ nginx ï¼Œå¦‚ä»¥ä¸‹ Labã€‚</p>
<pre tabindex="0"><code>$ kubectl run mynginx --image=nginx --replicas=1 --port=80
deployment.apps/mynginx created
$ kubectl expose deployment mynginx --port 80
service/mynginx exposed

$ kubectl get deploy,po,svc -o wide -l run=mynginx
NAME                            READY   UP-TO-DATE   AVAILABLE   AGE    CONTAINERS   IMAGES   SELECTOR
deployment.extensions/mynginx   1/1     1            1           115s   mynginx      nginx    run=mynginx

NAME                           READY   STATUS    RESTARTS   AGE    IP          NODE    NOMINATED NODE   READINESS GATES
pod/mynginx-568f57494d-nsc8r   1/1     Running   0          115s   10.42.1.2   node1   &lt;none&gt;           &lt;none&gt;

NAME              TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)   AGE   SELECTOR
service/mynginx   ClusterIP   10.43.220.117   &lt;none&gt;        80/TCP    27s   run=mynginx

$ curl 10.43.220.117
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
    body {
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    }
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;

&lt;p&gt;For online documentation and support please refer to
&lt;a href=&#34;http://nginx.org/&#34;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a href=&#34;http://nginx.com/&#34;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>å¦‚ä¸Šï¼Œå…¶å¯¦ä½¿ç”¨æ–¹å¼å’Œ Kubernetes ä½¿ç”¨åŸæœ¬è³‡æºæ–¹æ³•æ˜¯ä¸€æ¨£çš„ï¼Œæ‰€ä»¥è¦æ›´æ› install çš„å·¥å…·ï¼Œå…¶å¯¦ä¸¦ä¸æ˜¯å¤ªå›°é›£ã€‚</p>
<h2 id="ç§»é™¤å®‰è£">ç§»é™¤å®‰è£</h2>
<p>åœ¨ K3s Server ç«¯åŸ·è¡Œ</p>
<pre tabindex="0"><code>systemctl stop k3s &amp;&amp; /usr/local/bin/k3s-uninstall.sh
</code></pre><p>ï¼›åœ¨ k3s agent ç«¯åŸ·è¡Œ</p>
<pre tabindex="0"><code>systemctl stop k3s-agent &amp;&amp; /usr/local/bin/k3s-agent-uninstall.sh
</code></pre><h2 id="åœ¨-arm-ä¸Šé¢éƒ¨ç½²-k3s-cluster">åœ¨ ARM ä¸Šé¢éƒ¨ç½² K3s Cluster</h2>
<p>è€Œåœ¨ ARM ä¸Šé¢éƒ¨ç½²ï¼Œä¹Ÿæ˜¯é›·åŒçš„ï¼Œä¸éæœ‰ä»¥ä¸‹å¹¾é»æ˜¯éœ€è¦æ³¨æ„çš„</p>
<ul>
<li>è‹¥æ˜¯è¦ç·¨è­¯ Kernel è«‹ç¢ºå®š vxlan, iptables, netfilter, ip_vs ç­‰å¿…è¦çš„ module éƒ½æœ‰é–‹å•Ÿã€‚</li>
<li>è‹¥éœ€è¦å®‰è£ Docker ï¼Œè«‹ç¢ºå®š Cgroup åœ¨è©²ç·¨è­¯çš„ Kernel ç‰ˆæœ¬æ˜¯æ²’æœ‰ issue çš„ã€‚ä¹Ÿè«‹ç¢ºå®šä½¿ç”¨çš„ Kernel ç‰ˆæœ¬æ˜¯ç¬¦åˆ Kubernetes å®˜ç¶²ä¸Šçš„æè¿°ã€‚</li>
</ul>
<h2 id="çµèª">çµèª</h2>
<p>å› ç·£éš›æœƒä¸‹ï¼Œæ¥è§¸ K3s ï¼Œå…¶å¯¦è »æœ‰è¶£çš„ï¼Œè¦ºå¾—é‚Šç·£é‹ç®—å’Œé›²ç«¯é‹ç®—æœ‰å…±åŒé¡ä¼¼çš„æŠ€è¡“å¯ä»¥äº¤æµï¼Œä¹Ÿæ˜¯å¾ˆé–‹å¿ƒçš„ã€‚æœ€è¿‘ä¹Ÿå…‰äº†ä¸€äº›æ™‚é–“ï¼Œç¿»äº†ä¸€ä¸‹ K3s çš„ codeï¼Œè¦ºå¾—æœ‰è¶£ã€‚ä¹‹å¾Œè‹¥æœ‰æ™‚é–“ï¼Œä¹Ÿè¨±æœƒä¾†å¯«ä¸€ç¯‡æ·±å…¥ç ”ç©¶ K3s æºç¢¼çš„åˆ†äº«ã€‚</p>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://k3s.io/">https://k3s.io/</a></li>
<li><a href="https://rancher.com/docs/k3s/latest/en/">https://rancher.com/docs/k3s/latest/en/</a></li>
</ul>


    </main>
  </div>
  <footer>
    <div class="footer-wrapper">
      <p>Made with â¤ï¸ &mdash; Powered by <a href="https://gohugo.io/" target="_blank" rel="external">Hugo</a> and the <a href="https://github.com/bjacquemet/personal-web" target='_blank' rel="external">Personal Web</a> theme.</p>
      <p>@Samina Fu</p>
    </div>
  </footer>
  <link href="https://fonts.googleapis.com/css?family=Montserrat:500,600|Raleway:400,400i,600" rel="stylesheet">
  
  <script type="text/javascript">
    document.querySelector('.mobile-header').addEventListener('click', function () {
      var om = document.querySelector(".overlay-menu");
      if (document.querySelector('.hamburger').classList.contains("cross")) {
        document.querySelector('.hamburger').classList.remove("cross");
        om.style.display = "none";
        om.style.width = "0%";
        om.style.height = "0%";
      }
      else {
        document.querySelector('.hamburger').classList.add("cross");
        om.style.width = "100%";
        om.style.height = "80vh";
        om.style.display = "block";
      }
    });
  </script>
</body>
</html>
